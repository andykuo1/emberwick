!function(e){function t(t){for(var r,o,i=t[0],a=t[1],u=t[2],s=0,l=[];s<i.length;s++)o=i[s],P[o]&&l.push(P[o][0]),P[o]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r]);for(D&&D(t);l.length;)l.shift()();return S.push.apply(S,u||[]),n()}function n(){for(var e,t=0;t<S.length;t++){for(var n=S[t],r=!0,o=1;o<n.length;o++){var i=n[o];0!==P[i]&&(r=!1)}r&&(S.splice(t--,1),e=C(C.s=n[0]))}return e}var r=window.webpackHotUpdate;window.webpackHotUpdate=function(e,t){!function(e,t){if(!w[e]||!b[e])return;for(var n in b[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(v[n]=t[n]);0==--_&&0===g&&j()}(e,t),r&&r(e,t)};var o,i=!0,a="0d12a7a48b7d536ade7b",u=1e4,s={},l=[],c=[];var f=[],h="idle";function d(e){h=e;for(var t=0;t<f.length;t++)f[t].call(null,e)}var p,v,y,_=0,g=0,m={},b={},w={};function E(e){return+e+""===e?+e:e}function O(e){if("idle"!==h)throw new Error("check() is only allowed in idle status");return i=e,d("check"),function(e){return e=e||1e4,new Promise(function(t,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var r=new XMLHttpRequest,o=C.p+""+a+".hot-update.json";r.open("GET",o,!0),r.timeout=e,r.send(null)}catch(e){return n(e)}r.onreadystatechange=function(){if(4===r.readyState)if(0===r.status)n(new Error("Manifest request to "+o+" timed out."));else if(404===r.status)t();else if(200!==r.status&&304!==r.status)n(new Error("Manifest request to "+o+" failed."));else{try{var e=JSON.parse(r.responseText)}catch(e){return void n(e)}t(e)}}})}(u).then(function(e){if(!e)return d("idle"),null;b={},m={},w=e.c,y=e.h,d("prepare");var t=new Promise(function(e,t){p={resolve:e,reject:t}});for(var n in v={},P)k(n);return"prepare"===h&&0===g&&0===_&&j(),t})}function k(e){w[e]?(b[e]=!0,_++,function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("script");n.charset="utf-8",n.src=C.p+""+e+"."+a+".hot-update.js",t.appendChild(n)}(e)):m[e]=!0}function j(){d("ready");var e=p;if(p=null,e)if(i)Promise.resolve().then(function(){return M(i)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in v)Object.prototype.hasOwnProperty.call(v,n)&&t.push(E(n));e.resolve(t)}}function M(t){if("ready"!==h)throw new Error("apply() is only allowed in ready status");var n,r,o,i,u;function c(e){for(var t=[e],n={},r=t.slice().map(function(e){return{chain:[e],id:e}});r.length>0;){var o=r.pop(),a=o.id,u=o.chain;if((i=x[a])&&!i.hot._selfAccepted){if(i.hot._selfDeclined)return{type:"self-declined",chain:u,moduleId:a};if(i.hot._main)return{type:"unaccepted",chain:u,moduleId:a};for(var s=0;s<i.parents.length;s++){var l=i.parents[s],c=x[l];if(c){if(c.hot._declinedDependencies[a])return{type:"declined",chain:u.concat([l]),moduleId:a,parentId:l};-1===t.indexOf(l)&&(c.hot._acceptedDependencies[a]?(n[l]||(n[l]=[]),f(n[l],[a])):(delete n[l],t.push(l),r.push({chain:u.concat([l]),id:l})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];-1===e.indexOf(r)&&e.push(r)}}t=t||{};var p={},_=[],g={},m=function(){console.warn("[HMR] unexpected require("+O.moduleId+") to disposed module")};for(var b in v)if(Object.prototype.hasOwnProperty.call(v,b)){var O;u=E(b);var k=!1,j=!1,M=!1,S="";switch((O=v[b]?c(u):{type:"disposed",moduleId:b}).chain&&(S="\nUpdate propagation: "+O.chain.join(" -> ")),O.type){case"self-declined":t.onDeclined&&t.onDeclined(O),t.ignoreDeclined||(k=new Error("Aborted because of self decline: "+O.moduleId+S));break;case"declined":t.onDeclined&&t.onDeclined(O),t.ignoreDeclined||(k=new Error("Aborted because of declined dependency: "+O.moduleId+" in "+O.parentId+S));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(O),t.ignoreUnaccepted||(k=new Error("Aborted because "+u+" is not accepted"+S));break;case"accepted":t.onAccepted&&t.onAccepted(O),j=!0;break;case"disposed":t.onDisposed&&t.onDisposed(O),M=!0;break;default:throw new Error("Unexception type "+O.type)}if(k)return d("abort"),Promise.reject(k);if(j)for(u in g[u]=v[u],f(_,O.outdatedModules),O.outdatedDependencies)Object.prototype.hasOwnProperty.call(O.outdatedDependencies,u)&&(p[u]||(p[u]=[]),f(p[u],O.outdatedDependencies[u]));M&&(f(_,[O.moduleId]),g[u]=m)}var A,I=[];for(r=0;r<_.length;r++)u=_[r],x[u]&&x[u].hot._selfAccepted&&I.push({module:u,errorHandler:x[u].hot._selfAccepted});d("dispose"),Object.keys(w).forEach(function(e){!1===w[e]&&function(e){delete P[e]}(e)});for(var T,D,L=_.slice();L.length>0;)if(u=L.pop(),i=x[u]){var U={},R=i.hot._disposeHandlers;for(o=0;o<R.length;o++)(n=R[o])(U);for(s[u]=U,i.hot.active=!1,delete x[u],delete p[u],o=0;o<i.children.length;o++){var K=x[i.children[o]];K&&((A=K.parents.indexOf(u))>=0&&K.parents.splice(A,1))}}for(u in p)if(Object.prototype.hasOwnProperty.call(p,u)&&(i=x[u]))for(D=p[u],o=0;o<D.length;o++)T=D[o],(A=i.children.indexOf(T))>=0&&i.children.splice(A,1);for(u in d("apply"),a=y,g)Object.prototype.hasOwnProperty.call(g,u)&&(e[u]=g[u]);var Y=null;for(u in p)if(Object.prototype.hasOwnProperty.call(p,u)&&(i=x[u])){D=p[u];var F=[];for(r=0;r<D.length;r++)if(T=D[r],n=i.hot._acceptedDependencies[T]){if(-1!==F.indexOf(n))continue;F.push(n)}for(r=0;r<F.length;r++){n=F[r];try{n(D)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:u,dependencyId:D[r],error:e}),t.ignoreErrored||Y||(Y=e)}}}for(r=0;r<I.length;r++){var B=I[r];u=B.module,l=[u];try{C(u)}catch(e){if("function"==typeof B.errorHandler)try{B.errorHandler(e)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:u,error:n,originalError:e}),t.ignoreErrored||Y||(Y=n),Y||(Y=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:u,error:e}),t.ignoreErrored||Y||(Y=e)}}return Y?(d("fail"),Promise.reject(Y)):(d("idle"),new Promise(function(e){e(_)}))}var x={},P={0:0},S=[];function C(t){if(x[t])return x[t].exports;var n=x[t]={i:t,l:!1,exports:{},hot:function(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:o!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var r=0;r<e.length;r++)t._acceptedDependencies[e[r]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:O,apply:M,status:function(e){if(!e)return h;f.push(e)},addStatusHandler:function(e){f.push(e)},removeStatusHandler:function(e){var t=f.indexOf(e);t>=0&&f.splice(t,1)},data:s[e]};return o=void 0,t}(t),parents:(c=l,l=[],c),children:[]};return e[t].call(n.exports,n,n.exports,function(e){var t=x[e];if(!t)return C;var n=function(n){return t.hot.active?(x[n]?-1===x[n].parents.indexOf(e)&&x[n].parents.push(e):(l=[e],o=n),-1===t.children.indexOf(n)&&t.children.push(n)):(console.warn("[HMR] unexpected require("+n+") from disposed module "+e),l=[]),C(n)},r=function(e){return{configurable:!0,enumerable:!0,get:function(){return C[e]},set:function(t){C[e]=t}}};for(var i in C)Object.prototype.hasOwnProperty.call(C,i)&&"e"!==i&&"t"!==i&&Object.defineProperty(n,i,r(i));return n.e=function(e){return"ready"===h&&d("prepare"),g++,C.e(e).then(t,function(e){throw t(),e});function t(){g--,"prepare"===h&&(m[e]||k(e),0===g&&0===_&&j())}},n.t=function(e,t){return 1&t&&(e=n(e)),C.t(e,-2&t)},n}(t)),n.l=!0,n.exports}C.m=e,C.c=x,C.d=function(e,t,n){C.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},C.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},C.t=function(e,t){if(1&t&&(e=C(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(C.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)C.d(n,r,function(t){return e[t]}.bind(null,r));return n},C.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return C.d(t,"a",t),t},C.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},C.p="dist/",C.h=function(){return a};var A=window.webpackJsonp=window.webpackJsonp||[],I=A.push.bind(A);A.push=t,A=A.slice();for(var T=0;T<A.length;T++)t(A[T]);var D=I;S.push([15,1]),n()}([,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.assetManager=t,this._cache=new Map,this._loadQueue=new Map,this._cacheOnly=new Set,this._baseUrl=n,this._responseType=r}return r(e,[{key:"clear",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this._cache.keys()[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;this.unload(i)}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}this._loadQueue.clear(),this._cache.clear(),this._cacheOnly.clear()}},{key:"onLoadResource",value:function(e,t,n){return Promise.resolve(e)}},{key:"onUnloadResource",value:function(e,t){}},{key:"load",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=this,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];if(this._cache.has(e))throw new Error("Asset with url '"+e+"' is already loaded");if(this._loadQueue.has(e))throw new Error("Asset with url '"+e+"' is already loading");var u={promise:null,request:null};return this._cache.set(e,this.getDefaultAsset()),this._loadQueue.set(e,u),u.promise=new Promise(function(s,l){var c=o._baseUrl+e,f=u.request=new XMLHttpRequest;f.responseType=o._responseType,f.onreadystatechange=function(r){if(f.readyState===XMLHttpRequest.DONE)if(200===f.status)o.onLoadResource(f.response,t,e).then(function(t){console.log("[AssetLoader] Successfully loaded resource: '"+e+"'."),o.cache(e,t,!1,!0,!0),s(t)}).catch(function(t){console.log("[AssetLoader] Failed loading resource: '"+e+"'."),o.unload(e,a,!0),n&&n(t),l(t)});else{o.unload(e,a,!0);var i=new Error("Failed to load resource from server - "+f.status);n&&n(i),l(i)}},f.onerror=function(t){o.unload(e,a,!0);var r=new Error("Failed to load resource from server due to network error");n&&n(r),l(r)},f.oncancel=function(t){o.unload(e,!1,!0),r&&r(t),s(null)},i&&(f.onprogress=function(e){e.lengthComputable&&i(e)}),f.open("GET",c,!0),f.send()}),u.promise}},{key:"cache",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!(arguments.length>4&&void 0!==arguments[4]&&arguments[4])&&this._cache.has(e))throw new Error("Asset with url '"+e+"' is already cached");if(this._loadQueue.has(e)){if(!r)throw new Error("Asset with url '"+e+"' is already being loaded");this._loadQueue.delete(e)}n&&this._cacheOnly.add(e),this._cache.set(e,t)}},{key:"reload",value:function(e,t){if(!this._cache.has(e))throw new Error("Cannot find asset with url '"+e+"' to reload");if(this._cacheOnly.has(e))throw new Error("Trying to reload cache-only asset with url '"+e+"'");this._loadQueue.has(e)||(this.unload(e),this.load(e,t))}},{key:"unload",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this._cache.has(e))throw new Error("Cannot find asset with url '"+e+"' to unload");if(this._loadQueue.has(e)&&(n?this._loadQueue.delete(e):this._loadQueue.get(e).request.abort()),t){var r=this._cache.get(e);this.onUnloadResource(r,e),this._cacheOnly.has(e)&&this._cacheOnly.delete(e),this._cache.delete(e)}}},{key:"hasAsset",value:function(e){return this._cache.has(e)}},{key:"getAsset",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._loadQueue.has(e)?this._loadQueue.get(e).promise:this._cache.has(e)?Promise.resolve(this._cache.get(e)):t?this.load(e,null):Promise.resolve(this.getDefaultAsset())}},{key:"getAssetImmediately",value:function(e){return this._cache.has(e)?this._cache.get(e):this.getDefaultAsset()}},{key:"getDefaultAsset",value:function(){return null}},{key:"isAssetLoading",value:function(e){return this._loadQueue.has(e)}},{key:"isAssetFullyLoaded",value:function(e){return this._cache.has(e)&&!this._loadQueue.has(e)}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={__eventListeners:null,__events:null,__immediate:!0,__autoregister:!1,mixin:function(e){var t=e.prototype;Object.assign(t,r),delete t.mixin},allowImmediateEventUpdate:function(e){return this.__immediate=e,this},allowAutomaticEventRegister:function(e){return this.__autoregister=e,this},pollEvents:function(){if(this.__eventQueue)for(var e=100;this.__eventQueue.length>0&&--e>=0;){var t=this.__eventQueue.pop(),n=t[0],r=t[1];this.processEvent(n,r)}},processEvent:function(e,t){for(var n=this.__eventListeners.get(e),r=null,o=n.length;o--;){try{r=n[o].apply(null,t)}catch(e){console.error(e)}if(!0===r)break}},registerEvent:function(e){if(this.__eventListeners||(this.__eventListeners=new Map),this.__eventListeners.has(e))throw new Error("Already registered event '"+e+"'");this.__eventListeners.set(e,[])},unregisterEvent:function(e){if(this.__eventListeners){if(!this.__eventListeners.has(e))throw new Error("Unable to find event '"+e+"'");this.__eventListeners.delete(e)}},addEventListener:function(e,t){this.__eventListeners||(this.__eventListeners=new Map);var n=void 0;if(this.__eventListeners.has(e))n=this.__eventListeners.get(e);else{if(!this.__autoregister)throw new Error("Unable to find event '"+e+"'");n=[],this.__eventListeners.set(e,n)}n.push(t)},removeEventListener:function(e,t){if(this.__eventListeners){if(!this.__eventListeners.has(e))throw new Error("Unknown event '"+e+"'");for(var n=this.__eventListeners.get(e),r=!1,o=n.length;o--;)n[o]===t&&(n.splice(o,1),r=!0);if(!r)throw new Error("Unable to find listener for event '"+e+"'")}},clearEventListeners:function(e){if(this.__eventListeners)if(this.__eventListeners.has(e)){this.__eventListeners.get(e).length=0}else{if(!this.__autoregister)throw new Error("Unable to find event '"+e+"'");listeners=[],this.__eventListeners.set(e,listeners)}},countEventListeners:function(e){return this.__eventListeners&&this.__eventListeners.has(e)?this.__eventListeners.get(e).length:0},getEventListeners:function(e){return this.__eventListeners?this.__eventListeners.get(e):null},on:function(e,t){this.addEventListener(e,t)},once:function(e,t){var n=this;this.addEventListener(e,function r(){for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];try{t.apply(null,i)}finally{n.removeEventListener(e,r)}})},emit:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];try{if(!this.__eventListeners)return;var o=void 0;if(this.__eventListeners.has(e))o=this.__eventListeners.get(e);else{if(!this.__autoregister)throw new Error("Unable to find event '"+e+"'");o=[],this.__eventListeners.set(e,o)}this.__immediate?this.processEvent(e,n):(this.__eventQueue||(this.__eventQueue=[]),this.__eventQueue.push([e,n]))}finally{this.onEventProcessed.apply(this,[e].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(n)))}},onEventProcessed:function(e){}};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(45)),i=n(0);var a=new(function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"onComponentCreate",value:function(e,t){e.transform=i.mat4.create(),e.visible=!0,e.mesh="quad.mesh",e.material="rock.tex",e.drawMode="model"}},{key:"onComponentDestroy",value:function(e,t){e.transform=void 0,e.visible=void 0,e.mesh=void 0,e.material=void 0,e.drawMode=void 0}}]),t}());t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(1));var i=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"/","cacheonly"))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"load",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=(arguments.length>4&&void 0!==arguments[4]&&arguments[4],this),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];if(this._cache.has(e))throw new Error("Asset with url '"+e+"' is already loaded");if(this._loadQueue.has(e))throw new Error("Asset with url '"+e+"' is already loading");var a={promise:null,request:null};return this._cache.set(e,this.getDefaultAsset()),this._loadQueue.set(e,a),a.promise=new Promise(function(a,u){o&&o({loaded:0,total:1}),r.onLoadResource(null,t,e).then(function(t){console.log("[CacheLoader] Successfully loaded cached resource: '"+e+"'."),o&&o({loaded:1,total:1}),r.cache(e,t,!0,!0,!0),a(t)}).catch(function(t){console.log("[CacheLoader] Failed loading cached resource: '"+e+"'."),r.unload(e,i,!0),n&&n(t),u(t)})}),a.promise}},{key:"reload",value:function(e,t){throw new Error("Trying to reload cache-only asset with url '"+e+"'")}}]),t}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this._context=null,this._inputID=null}return r(e,[{key:"onContextRegister",value:function(e,t){if(null!=this._context)throw new Error("Cannot register input already registered with another context");this._context=e,this._inputID=t}},{key:"onContextUnregister",value:function(e,t){this._context=null,this._inputID=null}},{key:"processInput",value:function(e){return e}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._mapping=new Map}return r(e,[{key:"clear",value:function(){this._mapping.clear()}},{key:"registerAction",value:function(e,t,n,r){this.registerInputByID(i(e,t,n),r)}},{key:"unregisterAction",value:function(e){return this.unregisterInputByID(e._inputID,e)}},{key:"registerState",value:function(e,t,n,r,o,a,u){var s=i(e,t,n),l=i(r,o,a);this.registerInputByID(s,u),this.registerInputByID(l,u)}},{key:"unregisterState",value:function(e){this.unregisterInputByID(e._otherID,e),this.unregisterInputByID(e._inputID,e)}},{key:"registerRange",value:function(e,t,n,r){this.registerInputByID(i(e,t,n),r)}},{key:"unregisterRange",value:function(e){return this.unregisterInputByID(e._inputID,e)}},{key:"registerInputByID",value:function(e,t){if(!e)throw new Error("Cannot register input to empty input id");var n=void 0;return this._mapping.has(e)?n=this._mapping.get(e):this._mapping.set(e,n=[]),n.push(t),t.onContextRegister(this,e),t}},{key:"unregisterInputByID",value:function(e,t){if(this._mapping.has(e)){var n=this._mapping.get(e);if(n.includes(t))return n.splice(n.indexOf(t),1),t.onContextUnregister(this,e),!0}return!1}},{key:"getMappedInputs",value:function(e,t,n){return this._mapping.get(i(e,t,n))}}]),e}();function i(e,t,n){if(!e)throw new Error("Cannot get input id for non-existent input source");if(!n)throw new Error("Cannot get input id for non-existent key code");if(!t)throw new Error("Cannot get input id for non-existent event type");return e+"."+t+"."+n}t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(5));var i=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"processInput",value:function(e){return!0}}]),t}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=function(e){return e&&e.__esModule?e:{default:e}}(n(5));var a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._otherID=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"onContextRegister",value:function(e,n){if(null==this._inputID)o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onContextRegister",this).call(this,e,n);else if(null==this._otherID){if(this._context!=e)throw new Error("Cannot register state input calls to another context");this._otherID=n}}},{key:"onContextUnregister",value:function(e,n){n==this._inputID?this._inputID=null:n==this._otherID&&(this._otherID=null),null==this._inputID&&null==this._otherID&&o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onContextUnregister",this).call(this,e,n)}},{key:"processInput",value:function(e){if(null==this._otherID)throw new Error("Missing another registered input call for state input");return e.id==this._inputID||e.id!=this._otherID&&null}}]),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(5));var i=function(e){function t(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o));if("number"!=typeof r||"number"!=typeof n)throw new Error("Range bounds for input not specified");if(r<n)throw new Error("Max range must be greater than min range");i.min=n,i.max=r;var a=r-n;if(0==a)throw new Error("Range of input cannot be zero");return i._normal=a,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"processInput",value:function(e){return this.normalize(e.amount)}},{key:"normalize",value:function(e){return(e-this.min)/this._normal}}]),t}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MOUSE_X=-1,t.MOUSE_Y=-2,t.MOUSE_WHEEL_X=-3,t.MOUSE_WHEEL_Y=-4,t.MOUSE_LEFT=1,t.MOUSE_MIDDLE=2,t.MOUSE_RIGHT=3,t.KEY_LEFT=37,t.KEY_RIGHT=39,t.KEY_UP=38,t.KEY_DOWN=40,t.KEY_SPACE=32,t.KEY_TAB=9,t.KEY_ENTER=13,t.KEY_SHIFT=16,t.KEY_COLON=186,t.KEY_EQUAL=187,t.KEY_COMMA=188,t.KEY_DASH=189,t.KEY_PERIOD=190,t.KEY_FORWARD_SLASH=191,t.KEY_BACK_SLASH=220,t.KEY_GRAVE=192,t.KEY_OPEN_BRACKET=219,t.KEY_CLOSE_BRACKET=221,t.KEY_QUOTE=222,t.KEY_0=48,t.KEY_1=49,t.KEY_2=50,t.KEY_3=51,t.KEY_4=52,t.KEY_5=53,t.KEY_6=54,t.KEY_7=55,t.KEY_8=56,t.KEY_9=57,t.KEY_A=65,t.KEY_B=66,t.KEY_C=67,t.KEY_D=68,t.KEY_E=69,t.KEY_F=70,t.KEY_G=71,t.KEY_H=72,t.KEY_I=73,t.KEY_J=74,t.KEY_K=75,t.KEY_L=76,t.KEY_M=77,t.KEY_N=78,t.KEY_O=79,t.KEY_P=80,t.KEY_Q=81,t.KEY_R=82,t.KEY_S=83,t.KEY_T=84,t.KEY_U=85,t.KEY_V=86,t.KEY_W=87,t.KEY_X=88,t.KEY_Y=89,t.KEY_Z=90},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.entityManager=null,this.entityID=-1,this._dead=!1}return r(e,[{key:"setEntityID",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.entityID=e,this.entityManager=t}},{key:"onCreate",value:function(){}},{key:"onEarlyUpdate",value:function(e){}},{key:"onUpdate",value:function(e){}},{key:"onLateUpdate",value:function(e){}},{key:"onDestroy",value:function(){}},{key:"addComponent",value:function(e){return this.entityManager.addComponentToEntity(this.entityID,e)}},{key:"removeComponent",value:function(e){return this.entityManager.removeComponentFromEntity(this.entityID,e)}},{key:"getComponent",value:function(e){return this.entityManager.getComponentFromEntity(e,this.entityID)}},{key:"getEntityID",value:function(){return this.entityID}},{key:"getEntityManager",value:function(){return this.entityManager}},{key:"setDead",value:function(){this._dead=!0}},{key:"isDead",value:function(){return this._dead}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=s(n(11)),a=n(0),u=s(n(3));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.world=e,o.x=n,o.y=r,o.rotation=a.quat.create(),o.maxAge=5+20*Math.random(),o.age=o.maxAge,o.size=1,o.hspeed=.5*(2*Math.random()-1),o.vspeed=1+2*Math.random(),o.maxVSpeed=10,o.gravity=.6,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"onCreate",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onCreate",this).call(this),this.addComponent(u.default).material="color.tex"}},{key:"onUpdate",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUpdate",this).call(this,e),this.age-=e,this.age<0&&this.setDead(),this.size=this.age/this.maxAge,this.x+=this.hspeed*e,this.y+=this.vspeed*e,this.vspeed>this.maxVSpeed?this.vspeed=this.maxVSpeed:this.vspeed-=this.gravity*e;var n=this.getComponent(u.default);a.mat4.fromRotationTranslationScale(n.transform,this.rotation,a.vec3.fromValues(this.x,this.y,1),a.vec3.fromValues(this.size,this.size,1))}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0);var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewport=t,this.zNear=.1,this.zFar=1e3,this._projectionMatrix=o.mat4.create(),this._viewMatrix=o.mat4.create(),this._invertedProjectionMatrix=o.mat4.create(),this._invertedViewMatrix=o.mat4.create(),this.transformationMatrix=o.mat4.create(),this.rotationMatrix=o.mat4.create(),this.scaleMatrix=o.mat4.create(),this.inverseRotation=o.quat.create(),this.position=o.vec3.create(),this.rotation=o.quat.create(),this.scale=o.vec3.fromValues(1,1,1)}return r(e,[{key:"getViewPort",value:function(){return this.viewport}},{key:"getProjectionMatrix",value:function(){return o.mat4.identity(this._projectionMatrix),this._projectionMatrix}},{key:"getInvertedProjectionMatrix",value:function(){return o.mat4.invert(this._invertedProjectionMatrix,this.getProjectionMatrix()),this._invertedProjectionMatrix}},{key:"getViewMatrix",value:function(){return o.mat4.fromTranslation(this.transformationMatrix,this.position),o.mat4.fromQuat(this.rotationMatrix,o.quat.invert(this.inverseRotation,this.rotation)),o.mat4.fromScaling(this.scaleMatrix,this.scale),o.mat4.mul(this._viewMatrix,this.transformationMatrix,this.scaleMatrix),o.mat4.mul(this._viewMatrix,this.rotationMatrix,this._viewMatrix),this._viewMatrix}},{key:"getInvertedViewMatrix",value:function(){return o.mat4.invert(this._invertedViewMatrix,this.getViewMatrix()),this._invertedViewMatrix}},{key:"screenToWorld",value:function(e,t,n){throw new Error("Camera type does not support screen-space raycasting")}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.position=r.vec3.create(),this.direction=r.vec3.create()}},function(e,t,n){"use strict";var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(16)),o=function(e){return e&&e.__esModule?e:{default:e}}(n(33));window.addEventListener("load",function(e){r.initialize(new o.default)}),window.addEventListener("beforeunload",function(e){r.terminate()})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INSTANCE=void 0,t.initialize=function(e){var t=document.getElementById("glCanvas"),n=new o.default(t),i=new r.default,u=e;a.canvas=t,a.renderEngine=n,a.gameLoop=i,a.root=u,i.on("update",function(e,t){n.update(),u&&u.canUpdate()&&u.update(e),FPS.update(t)}),n.initialize().then(function(){return u.init(a)}).then(function(){return i.start()})},t.terminate=function(){a.gameLoop.stop(),a.root.exitImmediately(),a.renderEngine.terminate()};var r=i(n(17)),o=i(n(18));function i(e){return e&&e.__esModule?e:{default:e}}var a=t.INSTANCE={canvas:null,renderEngine:null,gameLoop:null,root:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FRAMES_PER_SECOND=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(2));var i=t.FRAMES_PER_SECOND=60,a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._running=!1,this.dt=0,this.prevtime=-1,this.registerEvent("update"),this.onWindowUpdate=this.onWindowUpdate.bind(this)}return r(e,[{key:"start",value:function(){this._running||(this._running=!0,window.requestAnimationFrame(this.onWindowUpdate))}},{key:"stop",value:function(){this._running&&(this.prevtime=-1,this._running=!1)}},{key:"onWindowUpdate",value:function(e){this.prevtime<0&&(this.prevtime=e-i),this._running&&(this.dt=e-this.prevtime,this.emit("update",this.dt/i,this.dt),this.prevtime=e,window.requestAnimationFrame(this.onWindowUpdate))}}]),e}();o.default.mixin(a),t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=d(n(19)),i=d(n(20)),a=d(n(21)),u=d(n(22)),s=d(n(23)),l=d(n(25)),c=d(n(28)),f=d(n(30)),h=d(n(32));function d(e){return e&&e.__esModule?e:{default:e}}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=t,this.gl=null,this.viewport=new o.default(t),this.assetManager=new i.default}return r(e,[{key:"initialize",value:function(){var e=this.canvas.getContext("webgl");this.gl=e;var t=this.assetManager,n=window.location+"res/";return t.registerAssetLoader("vert",new a.default(t,n)),t.registerAssetLoader("frag",new a.default(t,n)),t.registerAssetLoader("image",new u.default(t,n)),t.registerAssetLoader("obj",new s.default(t,n)),t.registerAssetLoader("mesh",new l.default(t,e)),t.registerAssetLoader("shader",new c.default(t,e)),t.registerAssetLoader("texture",new f.default(t,e)),t.registerAssetLoader("inputmap",new h.default(t,n)),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT),e.enable(e.DEPTH_TEST),Promise.resolve()}},{key:"terminate",value:function(){this.assetManager.clear(),this.gl=null}},{key:"update",value:function(){var e=this.gl;this.viewport.update(e)}},{key:"getViewPort",value:function(){return this.viewport}},{key:"getAssetManager",value:function(){return this.assetManager}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getGLContext",value:function(){return this.gl}}]),e}();t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._canvas=t,this.x=n,this.y=r,this._width=o,this._height=i}return r(e,[{key:"update",value:function(e){e.viewport(this.x,this.y,this.getWidth(),this.getHeight())}},{key:"getWidth",value:function(){return this._width>0?this._width:this._canvas.clientWidth}},{key:"getHeight",value:function(){return this._height>0?this._height:this._canvas.clientHeight}},{key:"getAspectRatio",value:function(){return this.getWidth()/this.getHeight()}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._loaders=new Map}return r(e,[{key:"clear",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this._loaders.values()[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.clear()}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}this._loaders.clear()}},{key:"registerAssetLoader",value:function(e,t){if("string"!=typeof e)throw new Error("Asset type must be a string");if(this._loaders.has(e))throw new Error("Found already registered loader for type '"+e+"'");this._loaders.set(e,t)}},{key:"getAssetLoader",value:function(e){if("string"!=typeof e)throw new Error("Asset type must be a string");if(!this._loaders.has(e))throw new Error("Cannot find registered loader for type '"+e+"'");return this._loaders.get(e)}},{key:"getAsset",value:function(e,t){return this.getAssetLoader(e).getAsset(t)}},{key:"getAssetImmediately",value:function(e,t){return this.getAssetLoader(e).getAssetImmediately(t)}},{key:"loadAsset",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.getAssetLoader(e).load(t,n)}},{key:"unloadAsset",value:function(e,t){this.getAssetLoader(e).unload(t)}},{key:"cacheAsset",value:function(e,t,n){if(void 0===n)throw new Error("Asset must exist to cache");this.getAssetLoader(e).cache(t,n)}},{key:"loadManifest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.toAssetDataList(),r=[],o=!0,i=!1,a=void 0;try{for(var u,s=n[Symbol.iterator]();!(o=(u=s.next()).done);o=!0){var l=u.value,c=l[0],f=l[1],h=l[2],d=this.getAssetLoader(c);if(d.hasAsset(f))r.push(d.getAsset(f,!1));else{var p=d.load(f,h);t&&(p=p.catch(function(e){return console.error("Ignoring load error: "+e)})),r.push(p)}}}catch(e){i=!0,a=e}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}return Promise.all(r)}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n(1));var o=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,"text"))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(1));var i=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,"blob"))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"onLoadResource",value:function(e,t,n){return new Promise(function(t,n){var r=URL.createObjectURL(e),o=new Image;o.onload=function(){URL.revokeObjectURL(r),t(o)},o.onerror=function(){URL.revokeObjectURL(r),n(new Error("Unable to load image"))},o.src=r})}}]),t}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(1)),i=a(n(24));function a(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,"text"))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"onLoadResource",value:function(e,t,n){return new Promise(function(t,n){try{t(function(e){var t=[],n=[],r=[],o=[],a=[],u=[],s=/v( +[\d|\.|\+|\-|e]+)( [\d|\.|\+|\-|e]+)( [\d|\.|\+|\-|e]+)/g,l=/vn( +[\d|\.|\+|\-|e]+)( [\d|\.|\+|\-|e]+)( [\d|\.|\+|\-|e]+)/g,c=/vt( +[\d|\.|\+|\-|e]+)( [\d|\.|\+|\-|e]+)/g,f=/f( +([\d]+)\/([\d]+)\/([\d]+))( ([\d]+)\/([\d]+)\/([\d]+))( ([\d]+)\/([\d]+)\/([\d]+))( ([\d]+)\/([\d]+)\/([\d]+))?/g,h=/f( +[\d|\.|\+|\-|e]+)( [\d|\.|\+|\-|e]+)( [\d|\.|\+|\-|e]+)/g,d=null,p=void 0,v=void 0,y=void 0,_=void 0;e=e.replace(/^#.*/g,"");for(;null!=(d=s.exec(e));)p=parseFloat(d[1]),v=parseFloat(d[2]),y=parseFloat(d[3]),t.push(p),t.push(v),t.push(y);for(;null!=(d=l.exec(e));)p=parseFloat(d[1]),v=parseFloat(d[2]),y=parseFloat(d[3]),r.push(p),r.push(v),r.push(y);for(;null!=(d=c.exec(e));)p=parseFloat(d[1]),v=parseFloat(d[2]),n.push(p),n.push(v);for(;null!=(d=f.exec(e));)p=parseInt(d[2]),v=parseInt(d[6]),y=parseInt(d[10]),o.push(p),o.push(v),o.push(y),p=parseInt(d[3]),v=parseInt(d[7]),y=parseInt(d[11]),a.push(p),a.push(v),a.push(y),p=parseInt(d[4]),v=parseInt(d[8]),y=parseInt(d[12]),u.push(p),u.push(v),u.push(y),void 0!==d[13]&&(_=parseInt(d[14]),o.push(_),_=parseInt(d[15]),a.push(_),_=parseInt(d[16]),u.push(_));for(;null!=(d=h.exec(e));)p=parseInt(d[2]),v=parseInt(d[6]),y=parseInt(d[10]),o.push(p),o.push(v),o.push(y),a.push(0),a.push(0),a.push(0),u.push(0),u.push(0),u.push(0),void 0!==d[13]&&(_=parseInt(d[14]),o.push(_),a.push(0),u.push(0));var g=void 0,m=void 0;m=o.length;for(var b=new Float32Array(3*m),w=0;w<m;++w)g=o[w]-1,b[3*w+0]=t[3*g+0],b[3*w+1]=t[3*g+1],b[3*w+2]=t[3*g+2];m=a.length;for(var E=new Float32Array(2*m),O=0;O<m;++O)g=a[O]-1,E[2*O+0]=n[2*g+0],E[2*O+1]=n[2*g+1];m=u.length;for(var k=new Float32Array(3*m),j=0;j<m;++j)g=u[j]-1,k[3*j+0]=r[3*g+0],k[3*j+1]=r[3*g+1],k[3*j+2]=r[3*g+2];m=o.length;for(var M=new Uint16Array(m),x=0;x<m;++x)M[x]=x;return new i.default(b,E,k,M)}(e))}catch(e){n(e)}})}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.positions=t,this.texcoords=n,this.normals=r,this.indices=o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(4)),i=a(n(26));function a(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.gl=n,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"onLoadResource",value:function(e,t,n){var r=this;return new Promise(function(e,o){if(!t.geometry)throw new Error("Missing required argument to load asset '"+n+"'");var a=r.gl,u=t.geometry;r.assetManager.getAsset("obj",u).then(function(t){var n=new i.default(a);n.addAttribute("a_position",t.positions,3),n.addAttribute("a_texcoord",t.texcoords,2),n.addAttribute("a_normal",t.normals,3),n.setElementAttribute(t.indices),e(n)}).catch(function(e){o(e)})})}},{key:"onUnloadResource",value:function(e,t){e&&e.delete()}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(27));function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(t){i(this,e),this._gl=t,this.attributes={},this.elementAttribute=null,this.vertexCount=0}return r(e,[{key:"delete",value:function(){for(var e in this.attributes)this.attributes[e].delete(),delete this.attributes[e];null!==this.elementAttribute&&(this.elementAttribute.delete(),this.elementAttribute=null)}},{key:"bind",value:function(e){for(var t in this.attributes){var n=e.attributes[t];this.attributes[t].bind(n)}null!==this.elementAttribute&&this.elementAttribute.bind()}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._gl.TRIANGLES,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._gl;if(null!==this.elementAttribute){var r=this.elementAttribute.getBufferDataType();n.drawElements(e,this.vertexCount,r,t)}else n.drawArrays(e,t,this.vertexCount)}},{key:"setElementAttribute",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._gl.STATIC_DRAW;if(null!==this.elementAttribute)throw new Error("Element attribute already exists for mesh");var n=this._gl,r=new u(n,n.ELEMENT_ARRAY_BUFFER,e,1,t);this.elementAttribute=r,this.vertexCount=e.length}},{key:"removeElementAttribute",value:function(){if(null===this.elementAttribute)throw new Error("Element attribute already exists for mesh");this.elementAttribute.delete(),this.elementAttribute=null}},{key:"hasElementAttribute",value:function(){return null!==this.elementAttribute}},{key:"getElementAttribute",value:function(){return this.elementAttribute}},{key:"addAttribute",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._gl.STATIC_DRAW;if(void 0!==this.attributes[e])throw new Error("Attribute with name '"+e+"' already exists for mesh");var o=this._gl,i=new u(o,o.ARRAY_BUFFER,t,n,r);this.attributes[e]=i}},{key:"removeAttribute",value:function(e){if(void 0===this.attributes[e])throw new Error("Cannot find attribute with name '"+e+"' for mesh");this.attributes[e].delete(),delete this.attributes[e]}},{key:"hasAttribute",value:function(e){return null!==this.attributes[e]}},{key:"getAttribute",value:function(e){return this.attributes[e]}}]),e}(),u=function(){function e(t,n,r,a,u){var s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];i(this,e),this._gl=t,this.vertexSize=a,this.normalized=s,this.bufferObject=new o.default(t,n,u),this.bufferObject.setData(r)}return r(e,[{key:"delete",value:function(){this.bufferObject.delete()}},{key:"bind",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this._gl,o=this.bufferObject.type;if(r.bindBuffer(o,this.bufferObject.handle),o===r.ARRAY_BUFFER){if(e<0)throw new Error("Invalid attribute location");r.vertexAttribPointer(e,this.vertexSize,this.bufferObject.dataType,this.normalized,t,n)}}},{key:"unbind",value:function(){var e=this.bufferObject.type;gl.bindBuffer(e,0)}},{key:"setBufferData",value:function(e){this.bufferObject.setData(e)}},{key:"updateBufferData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.bufferObject.updateData(e,t)}},{key:"getBufferDataType",value:function(){return this.bufferObject.dataType}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var o=t.createBuffer();this._gl=t,this._handle=o,this.type=n,this.usage=r,this.dataType=t.BYTE}return r(e,[{key:"delete",value:function(){var e=this._gl,t=this._handle;e.deleteBuffer(t),this._handle=0}},{key:"bind",value:function(){this._gl.bindBuffer(this.type,this._handle)}},{key:"unbind",value:function(){this._gl.bindBuffer(this.type,0)}},{key:"setData",value:function(e){var t=this._gl;if(e instanceof Float32Array)this.dataType=t.FLOAT,t.bindBuffer(this.type,this._handle),t.bufferData(this.type,e,this.usage);else{if(!(e instanceof Uint16Array))throw new Error("Unsupported buffer data type");this.dataType=t.UNSIGNED_SHORT,t.bindBuffer(this.type,this._handle),t.bufferData(this.type,e,this.usage)}return this}},{key:"updateData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._gl;return n.bindBuffer(this.type,this._handle),n.bufferSubData(this.type,t,e),this}},{key:"handle",get:function(){return this._handle}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(4)),i=a(n(29));function a(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.gl=n,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"onLoadResource",value:function(e,t,n){var r=this;return new Promise(function(e,o){if(!t.vertexShader)throw new Error("Missing required argument to load asset '"+n+"'");if(!t.fragmentShader)throw new Error("Missing required argument to load asset '"+n+"'");var a=r.gl,u=t.vertexShader,s=t.fragmentShader;r.assetManager.getAsset("vert",u).then(function(t){r.assetManager.getAsset("frag",s).then(function(n){var r=new i.default(a,t,n);e(r)})})})}},{key:"onUnloadResource",value:function(e,t){e&&e.delete()}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),console.log("Creating shader program...");var o=null,a=null;console.log("...creating vertex shader...");try{o=i(t,t.VERTEX_SHADER,n)}catch(e){throw e}console.log("...creating fragment shader...");try{a=i(t,t.FRAGMENT_SHADER,r)}catch(e){throw t.deleteShader(o),e}console.log("...attaching shaders...");var u=t.createProgram();if(t.attachShader(u,o),t.attachShader(u,a),console.log("...linking shaders..."),t.linkProgram(u),!t.getProgramParameter(u,t.LINK_STATUS)){var s=t.getProgramInfoLog(u);throw t.detachShader(u,o),t.detachShader(u,a),t.deleteShader(o),t.deleteShader(a),new Error("Unable to initailize shader program: "+s)}for(var l in console.log("...finding attributes..."),this.attributes=function(e,t){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<r;++o){var i=e.getActiveAttrib(t,o),a=i.name,u=e.getAttribLocation(t,a);n[a]=u,console.log("......found attribute '"+a+"'...")}return n}(t,u),this._names={},this.attributes)this._names[this.attributes[l]]=l;console.log("...finding uniforms..."),this.uniforms=function(e,t){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),o=0;o<r;++o){var i=e.getActiveUniform(t,o),a=i.name,u=e.getUniformLocation(t,a);n[a]=u,console.log("......found unifrom '"+a+"'...")}return n}(t,u),this._handle=u,this._vertexShader=o,this._fragmentShader=a,this._gl=t}return r(e,[{key:"delete",value:function(){var e=this._gl,t=this._handle,n=this.attributes;Object.keys(n).forEach(function(e){delete n[e]});var r=this.uniforms;Object.keys(r).forEach(function(e){delete r[e]});var o=this._vertexShader;e.detachShader(t,o),e.deleteShader(o),this._vertexShader=0;var i=this._fragmentShader;e.detachShader(t,i),e.deleteShader(i),this._fragmentShader=0,e.deleteProgram(t),this._handle=0}},{key:"validate",value:function(){var e=this._gl,t=this._handle;return e.validateProgram(t),!!e.getProgramParameter(t,e.VALIDATE_STATUS)}},{key:"bind",value:function(){var e=this._gl;for(var t in e.useProgram(this._handle),this.attributes)e.enableVertexAttribArray(this.attributes[t])}},{key:"unbind",value:function(){var e=this._gl;for(var t in this.attributes)e.disableVertexAttribArray(this.attributes[t])}},{key:"handle",get:function(){return this._handle}},{key:"vertexShader",get:function(){return this._vertexShader}},{key:"fragmentShader",get:function(){return this._fragmentShader}}]),e}();function i(e,t,n){var r=e.createShader(t);if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){var o=e.getShaderInfoLog(r);throw e.deleteShader(r),new Error("An error occured compiling shader: "+o)}return r}t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(4)),i=a(n(31));function a(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.gl=n,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"onLoadResource",value:function(e,t,n){var r=this;return new Promise(function(e,o){if(!t.image)throw new Error("Missing required argument to load asset '"+n+"'");var a=r.gl,u=t.image;r.assetManager.getAsset("image",u).then(function(t){var n=new i.default(a);n.setData(t),e(n)})})}},{key:"onUnloadResource",value:function(e,t){e&&e.delete()}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);var r=t.RGBA,o=t.RGBA,i=t.UNSIGNED_BYTE,a=new Uint8Array([255,0,0,255]);t.texImage2D(t.TEXTURE_2D,0,r,1,1,0,o,i,a),this._width=1,this._height=1,this._gl=t,this._handle=n}return r(e,[{key:"delete",value:function(){var e=this._gl,t=this._handle;e.deleteTexture(t),this._handle=0}},{key:"setData",value:function(e){var t=this._gl,n=this._handle;if(!(e instanceof Image))throw new Error("Unknown image data type is not supported");var r=t.RGBA,o=e.width,a=e.height,u=t.RGBA,s=t.UNSIGNED_BYTE;t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,r,u,s,e),this._width=o,this._height=a,i(o)&&i(a)?t.generateMipmap(t.TEXTURE_2D):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR))}},{key:"bind",value:function(e){var t=this._gl,n=this._handle;t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,n)}},{key:"getWidth",value:function(){return this._width}},{key:"getHeight",value:function(){return this._height}}]),e}();function i(e){return 0==(e&e-1)}t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=c(n(1)),i=c(n(6)),a=c(n(7)),u=c(n(8)),s=c(n(9)),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(10));function c(e){return e&&e.__esModule?e:{default:e}}function f(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var h=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,"text"))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"onLoadResource",value:function(e,t,n){return new Promise(function(t,n){try{t(function(e){var t=JSON.parse(e),n=new i.default,r=void 0,o=void 0,c=void 0,h=void 0,d=void 0;for(var p in t)if(r=t[p],o=r.type,c=r.args,(h=r.opts||[]).unshift(p),"state"===o)d=new(Function.prototype.bind.apply(u.default,[null].concat(f(h)))),n.registerState(c[0],c[1],l[c[2]],c[3],c[4],l[c[5]],d);else if("action"===o)d=new(Function.prototype.bind.apply(a.default,[null].concat(f(h)))),n.registerRange(c[0],c[1],l[c[2]],d);else{if("range"!==o)throw new Error("Unknown event type for input mapping '"+o+"'");d=new(Function.prototype.bind.apply(s.default,[null].concat(f(h)))),n.registerRange(c[0],c[1],l[c[2]],d)}return n}(e))}catch(e){n(e)}})}}]),t}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=(n(0),h(n(34))),a=h(n(3)),u=h(n(46)),s=(h(n(12)),h(n(48))),l=h(n(49)),c=(h(n(50)),h(n(51))),f=h(n(52));function h(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var y=function(e){function t(){d(this,t);var e=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.renderer=null,e.player=null,e.score=0,e}return v(t,i.default),r(t,[{key:"onLoad",value:function(e){var n=this;return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onLoad",this).call(this,e).then(function(){return n.renderer=new _(n,e.renderEngine),n.renderer.load()})}},{key:"onStart",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onStart",this).call(this,e);var n=this.entityManager;n.registerComponentClass(a.default),this.onWorldCreate(n)}},{key:"onWorldCreate",value:function(e){this.player=e.addCustomEntity(new u.default(this))}},{key:"onInputUpdate",value:function(e){if(o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onInputUpdate",this).call(this,e),e.getAction("cursorPrimary")){var n=e.getRange("lookX",!1),r=e.getRange("lookY",!1),i=this.renderer.getActiveCamera().screenToWorld(n,r).position;i[2]=0;var a=this.player,u=a.x-i[0],s=a.y-i[1],l=u*u+s*s,c=a.radius+a.bufferRadius;l<c*c&&(a.onHit(),++this.score)}}},{key:"onUpdate",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUpdate",this).call(this,e),this.renderer.update()}},{key:"onUnload",value:function(e){this.renderer.unload(),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUnload",this).call(this,e)}}]),t}();t.default=y;var _=function(e){function t(e,n){d(this,t);var r=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.target=e,r.renderEngine=n,r.camera=new c.default(r.renderEngine.getViewPort()),r.camera.position[2]=-50,r.drawableRenderer=new f.default(r.renderEngine.getAssetManager()),r}return v(t,s.default),r(t,[{key:"load",value:function(){var e=this.renderEngine.getAssetManager(),n=(this.renderEngine.getGLContext(),new l.default);return n.addAsset("vert","shader.vert"),n.addAsset("frag","shader.frag"),n.addAsset("shader","shader.shader",{vertexShader:"shader.vert",fragmentShader:"shader.frag"}),n.addAsset("image","color.png"),n.addAsset("texture","color.tex",{image:"color.png"}),n.addAsset("image","rock.jpg"),n.addAsset("texture","rock.tex",{image:"rock.jpg"}),n.addAsset("image","font.png"),n.addAsset("texture","font.tex",{image:"font.png"}),n.addAsset("image","wooden_crate.jpg"),n.addAsset("texture","wooden_crate.tex",{image:"wooden_crate.jpg"}),n.addAsset("obj","quad.obj"),n.addAsset("mesh","quad.mesh",{geometry:"quad.obj"}),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"load",this).call(this).then(function(){return e.loadManifest(n)})}},{key:"update",value:function(){var e=this.renderEngine.getGLContext();this.drawableRenderer.render(e,this.target,this.camera)}},{key:"getActiveCamera",value:function(){return this.camera}}]),t}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=l(n(35)),a=l(n(36)),u=l(n(40)),s=l(n(44));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.entityManager=new a.default,e.inputContext=new s.default,e.inputManager=null,e.onInputUpdate=e.onInputUpdate.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"onLoad",value:function(e){var n=this;if(!e.canvas)throw new Error("Missing canvas from gamestate opts");if(!e.renderEngine)throw new Error("Missing renderEngine from gamestate opts");return this.inputManager=new u.default(e.canvas),e.renderEngine.getAssetManager().loadAsset("inputmap","inputmap/default.json").then(function(e){n.inputContext.setInputMapping(e)}),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onLoad",this).call(this,e)}},{key:"onStart",value:function(e){this.inputManager.addContext(this.inputContext),this.inputManager.addCallback(this.onInputUpdate)}},{key:"onInputUpdate",value:function(e){}},{key:"onUpdate",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUpdate",this).call(this,e),this.inputManager.doInputUpdate(),this.entityManager.update(e)}},{key:"onStop",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onStop",this).call(this,e),this.inputManager.removeCallback(this.onInputUpdate),this.inputManager.removeContext(this.inputContext)}},{key:"onUnload",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUnload",this).call(this,e),this.entityManager.clear(),this.inputManager.destroy()}},{key:"getEntityManager",value:function(){return this.entityManager}},{key:"getInputManager",value:function(){return this.inputManager}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(2));var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._opts=null,this._prevState=null,this._nextState=null,this._cacheNextState=null,this._cacheNextOpts=null,this._cacheExit=!1,this._isLoaded=!1,this._suspended=!1,this.registerEvent("load"),this.registerEvent("unload")}return r(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this._isLoaded)throw new Error("Cannot initialize state already loaded");if(null!==this._prevState)throw new Error("Cannot initialize state already initialized from another state");this._prevState=n,console.log("[GameState] Loading game state '"+this.constructor.name+"'...");var o=this.onLoad(e).then(function(){t._opts=e,t._isLoaded=!0,t.emit("load",t)});return r?o.then(function(){console.log("[GameState] Starting game state '"+t.constructor.name+"'..."),t.onStart(e)}):o}},{key:"update",value:function(e){if(!this._isLoaded)throw new Error("Trying to update state that is not yet loaded");if(this._suspended||this.onUpdate(e),null!==this._nextState&&this._nextState.update(e),this.onUpdateState(e),this._cacheExit)console.log("[GameState] Exiting game state '"+this.constructor.name+"'..."),this._cacheExit=!1,this.exitImmediately();else if(null!==this._cacheNextState){console.log("[GameState] Changing game state for '"+this.constructor.name+"'...");var t=this._cacheNextState,n=this._cacheNextOpts||this._opts;this._cacheNextState=null,this._cacheNextOpts=null,this._nextGameState(t,n)}}},{key:"suspend",value:function(){if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&!this._isLoaded)throw new Error("Trying to suspend state that is not yet initialized");this._suspended||(console.log("[GameState] ...suspending game state '"+this.constructor.name+"'..."),this._suspended=!0,this.onSuspend())}},{key:"resume",value:function(){if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&!this._isLoaded)throw new Error("Trying to resume state that is not yet initialized");this._suspended&&(console.log("[GameState] ...resuming game state '"+this.constructor.name+"'..."),this._suspended=!1,this.onResume())}},{key:"exit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._isLoaded)throw new Error("Trying to exit state that is not yet loaded");if(!e&&null!==this._nextState)throw new Error("Trying to exit a dependent state");this._cacheExit=!0}},{key:"exitImmediately",value:function(){null!==this._nextState&&(console.log("[GameState] Exiting child game state for '"+this.constructor.name+"'..."),this._nextState.exitImmediately(),this._nextState=null),console.log("[GameState] Stopping game state '"+this.constructor.name+"'...");try{this.onStop()}catch(e){console.error(e)}if(null!==this._prevState&&(this._prevState._nextState=null,this._prevState.onChangeState(this._prevState,this)),null!==this._cacheNextState){if(null===this._prevState)throw new Error("Cannot replace current state while exiting the root state");var e=this._cacheNextState,t=this._cacheNextOpts;this._cacheNextState=null,this._cacheNextOpts=null,this._prevState.nextGameState(e,t)}this._prevState=null,console.log("[GameState] Unloading game state '"+this.constructor.name+"'...");try{this.onUnload(this._opts)}catch(e){console.error(e)}this._isLoaded=!1,this._opts=null,this._suspended=!1,this.emit("unload",this)}},{key:"nextGameState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null!==this._cacheNextState)throw new Error("Trying to set multiple next states");if(this.isValidNextGameState(e))return this._cacheNextState=e,this._cacheNextOpts=t,e;throw new Error("Invalid next game state")}},{key:"getNextGameState",value:function(){return this._nextState}},{key:"getPrevGameState",value:function(){return this._prevState}},{key:"canUpdate",value:function(){return this._isLoaded}},{key:"_nextGameState",value:function(e,t){var n=this;return e.init(t,this,!1).then(function(){n._nextState=e,n.onChangeState(e,n),console.log("[GameState] Starting next game state for '"+n.constructor.name+"'..."),e.onStart(t)})}},{key:"onUpdateState",value:function(e){}},{key:"onChangeState",value:function(e,t){console.log("[GameState] Changing state from '"+t.constructor.name+"' to '"+e.constructor.name+"'..."),e!==this?this.suspend():this.resume()}},{key:"onLoad",value:function(e){return Promise.resolve()}},{key:"onStart",value:function(e){}},{key:"onUpdate",value:function(e){}},{key:"onSuspend",value:function(){}},{key:"onResume",value:function(){}},{key:"onStop",value:function(e){}},{key:"onUnload",value:function(e){}},{key:"isValidNextGameState",value:function(t){return t instanceof e}},{key:"isSuspended",value:function(){return this._suspended}}]),e}();o.default.mixin(i),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=s(n(37)),a=s(n(38)),u=s(n(39));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.nextEntityID=1,e.components=new Map,e.entities=new Set,e.tags=new Map,e.customEntities=new u.default(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"clear",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clear",this).call(this),this.customEntities.clear(),this.entities.clear(),this.tags.clear();var e=!0,n=!1,r=void 0;try{for(var i,a=this.components.values()[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){i.value.clear()}}catch(e){n=!0,r=e}finally{try{!e&&a.return&&a.return()}finally{if(n)throw r}}}},{key:"update",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this,e),this.customEntities.update(e)}},{key:"registerComponentClass",value:function(e){if(this.components.has(e))throw new Error("Already registered component for '"+e+"'");this.components.set(e,new a.default(e))}},{key:"unregisterComponentClass",value:function(e){if(!this.components.has(e))throw new Error("Cannot find registered component for '"+e+"'");this.components.delete(e)}},{key:"createEntity",value:function(){var e=this.getNextAvailableEntityID();this.entities.add(e);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=!0,i=!1,a=void 0;try{for(var u,s=n[Symbol.iterator]();!(o=(u=s.next()).done);o=!0){var l=u.value;this.addTagToEntity(e,l)}}catch(e){i=!0,a=e}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}return e}},{key:"destroyEntity",value:function(e){if(this.entities.has(e)){if(this.isCustomEntity(e)){var t=this.getCustomEntity(e);t.isDead()||(t.setDead(),t.onDestroy())}this.entities.delete(e);var n=!0,r=!1,o=void 0;try{for(var i,a=this.tags.values()[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var u=i.value;u.has(e)&&u.delete(e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}var s=!0,l=!1,c=void 0;try{for(var f,h=this.components.values()[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){f.value.destroyComponent(e)}}catch(e){l=!0,c=e}finally{try{!s&&h.return&&h.return()}finally{if(l)throw c}}return!0}return!1}},{key:"hasEntity",value:function(e){return this.entities.has(e)}},{key:"addCustomEntity",value:function(e){return this.customEntities.addEntity(e)}},{key:"getCustomEntity",value:function(e){return this.customEntities.getEntityByID(e)}},{key:"isCustomEntity",value:function(e){return this.customEntities.hasEntityByID(e)}},{key:"addComponentToEntity",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.components.get(t);if(!r)throw new Error("Unable to find registered component manager for class '"+t+"'");var o=r.createComponent(e);return n&&n.apply(null,o),o}},{key:"removeComponentFromEntity",value:function(e,t){var n=this.components.get(t);if(!n)throw new Error("Unable to find registered component manager for class '"+t+"'");return n.destroyComponent(e)}},{key:"getComponentFromEntity",value:function(e,t){var n=this.components.get(e);if(!n)throw new Error("Unable to find registered component manager for class '"+e+"'");return n.getComponent(t)}},{key:"getComponentsFromTag",value:function(e,t){var n=[];if(this.tags.has(t)){var r=void 0,o=this.tags.get(t),i=!0,a=!1,u=void 0;try{for(var s,l=o[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value;(r=this.getComponentFromEntity(e,c))&&n.push(r)}}catch(e){a=!0,u=e}finally{try{!i&&l.return&&l.return()}finally{if(a)throw u}}}return n}},{key:"getComponents",value:function(e){return this.getComponentsByClass(e)}},{key:"getComponentsByClass",value:function(e){var t=this.components.get(e);if(!t)throw new Error("Unable to find registered component manager for class '"+e+"'");return t.getComponents()}},{key:"getComponentsByEntity",value:function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var i,a=this.components.values()[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var u=i.value.getComponent(e);u&&t.push(u)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return t}},{key:"addTagToEntity",value:function(e,t){var n=this.tags.get(t);n||this.tags.set(t,n=new Set),n.add(e)}},{key:"removeTagFromEntity",value:function(e,t){var n=this.tags.get(t);n&&n.has(e)&&n.delete(e)}},{key:"getEntitiesByComponent",value:function(e){return this.components.get(e).getEntities()}},{key:"getEntitiesByTag",value:function(e){return this.tags.get(e)}},{key:"getEntities",value:function(){return this.entities}},{key:"getCustomEntities",value:function(){return this.customEntities.getEntities()}},{key:"getNextAvailableEntityID",value:function(){return this.nextEntityID++}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.systems=new Map}return r(e,[{key:"clear",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.systems.values()[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.terminate(this)}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}this.systems.clear()}},{key:"update",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.systems.values()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.update(e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}},{key:"addSystem",value:function(e,t){t.setEntityManager(this),t.initialize(this),this.systems.set(e,t)}},{key:"removeSystem",value:function(e,t){t.terminate(this),t.setEntityManager(null),this.systems.delete(e)}},{key:"getSystem",value:function(e){return this.systems.get(e)}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.componentClass=t,this.componentInstances=new Map,this.cached=[]}return r(e,[{key:"createComponent",value:function(e){var t=this.componentInstances.get(e);return t?(this.componentClass.onComponentDestroy(t,e),this.componentClass.onComponentCreate(t,e)):(t=this.allocateComponent(),this.componentClass.onComponentCreate(t,e),this.componentInstances.set(e,t)),t}},{key:"destroyComponent",value:function(e){var t=this.componentInstances.get(e);return!!t&&(this.componentInstances.delete(e),this.componentClass.onComponentDestroy(t,e),this.deallocateComponent(t),!0)}},{key:"getComponent",value:function(e){return this.componentInstances.get(e)}},{key:"getComponents",value:function(){return this.componentInstances.values()}},{key:"getEntities",value:function(){return this.componentInstances.keys()}},{key:"allocateComponent",value:function(){if(this.cached.length<=0)for(var e=10;e>=0;--e)this.cached.push({});return this.cached.pop()}},{key:"deallocateComponent",value:function(e){this.cached.push(e)}},{key:"clearCache",value:function(){this.cached.length=0}},{key:"clear",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.componentInstances.values()[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;this.deallocateComponent(i)}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}this.componentInstances.clear()}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.entityManager=t,this.entities=new Map,this.destroyCache=[],this.createQueue=[],this.createCache=[],this._useCache=!1}return r(e,[{key:"clear",value:function(){this.destroyCache.length=0,this.createCache.length=0,this.createQueue.length=0;var e=!0,t=!1,n=void 0;try{for(var r,o=this.entities.values()[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value,a=i.getEntityID();this.entityManager.hasEntity(a)&&(i.isDead()&&(i.onDestroy(),i.setEntityID(-1)),this.entityManager.destroyEntity(a))}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}this.entities.clear()}},{key:"update",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.entities.values()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.isDead()||a.onEarlyUpdate(e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this._useCache=!0;for(var u=this.createQueue.length>0,s=100;u;){for(;this.createQueue.length>0&&u;){var l=this.createQueue.shift(),c=l.getEntityID();if(-1===c)throw new Error("Invalid entity id");l.onCreate(),this.entities.set(c,l),--s<0&&(u=!1)}if(this.createCache.length>0){var f=!0,h=!1,d=void 0;try{for(var p,v=this.createCache[Symbol.iterator]();!(f=(p=v.next()).done);f=!0){var y=p.value;this.createQueue.unshift(y)}}catch(e){h=!0,d=e}finally{try{!f&&v.return&&v.return()}finally{if(h)throw d}}this.createCache.length=0}else u=!1}this._useCache=!1;var _=!0,g=!1,m=void 0;try{for(var b,w=this.entities.values()[Symbol.iterator]();!(_=(b=w.next()).done);_=!0){var E=b.value;E.isDead()?this.destroyCache.push(E):E.onUpdate(e)}}catch(e){g=!0,m=e}finally{try{!_&&w.return&&w.return()}finally{if(g)throw m}}var O=!0,k=!1,j=void 0;try{for(var M,x=this.destroyCache[Symbol.iterator]();!(O=(M=x.next()).done);O=!0){var P=M.value,S=P.getEntityID();if(this.entityManager.hasEntity(S)){if(P.onDestroy(),!P.isDead())throw new Error("Entity must be dead after onDestroy");this.entityManager.destroyEntity(S)}P.setEntityID(-1,null),this.entities.delete(S)}}catch(e){k=!0,j=e}finally{try{!O&&x.return&&x.return()}finally{if(k)throw j}}this.destroyCache.length=0;var C=!0,A=!1,I=void 0;try{for(var T,D=this.entities.values()[Symbol.iterator]();!(C=(T=D.next()).done);C=!0){var L=T.value;L.isDead()||L.onLateUpdate(e)}}catch(e){A=!0,I=e}finally{try{!C&&D.return&&D.return()}finally{if(A)throw I}}}},{key:"addEntity",value:function(e){if(-1!==e.getEntityID())throw new Error("Entity is already created by another manager");this._useCache?this.createCache.unshift(e):this.createQueue.unshift(e);var t=this.entityManager.createEntity("entity");return e.setEntityID(t,this.entityManager),e}},{key:"hasEntityByID",value:function(e){return this.entities.has(e)}},{key:"getEntityByID",value:function(e){return this.entities.get(e)}},{key:"getEntities",value:function(){return this.entities.values()}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=f(n(41)),i=f(n(42)),a=f(n(43)),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(10)),s=f(n(7)),l=f(n(8)),c=f(n(9));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._canvas=t,this._inputEvent={id:null,down:!1,amount:0},this._contexts=[],this._callbacks=[],this._priorityComparator=function(e,t){return e[1]-t[1]},this._inputFrame=new a.default,this._mouse=null,this._mousedown=null,this._mouseup=null,this._mousemove=null,this._keyboard=null,this._keyup=null,this._keydown=null,this._gamepad=null,this.setMouse(new o.default(t)),this.setKeyboard(new i.default)}return r(e,[{key:"destroy",value:function(){null!==this._keyboard&&this._keyboard.delete(),null!==this._mouse&&this._mouse.delete()}},{key:"setKeyboard",value:function(e){var t=this;null!==this._keyboard&&(this._keyboard.removeEventListener("down",this._keydown),this._keyboard.removeEventListener("up",this._keyup),this._keyboard=null),this._keydown=function(e){e.repeat||t.onInput("key","down",e.which)},this._keyup=function(e){t.onInput("key","up",e.which)},e.on("down",this._keydown),e.on("up",this._keyup),this._keyboard=e}},{key:"getKeyboard",value:function(){return this._keyboard}},{key:"setMouse",value:function(e){var t=this;null!==this._mouse&&(this._mouse.removeEventListener("down",this._mousedown),this._mouse.removeEventListener("up",this._mouseup),this._mouse.removeEventListener("move",this._mousemove),this._mouse=null),this._mousedown=function(e){e.repeat||t.onInput("mouse","down",e.which)},this._mouseup=function(e){t.onInput("mouse","up",e.which)},this._mousemove=function(e){t.onInput("mouse","move",u.MOUSE_X,e.movementX),t.onInput("mouse","move",u.MOUSE_Y,e.movementY);var n=t._canvas.getBoundingClientRect();t.onInput("mouse","pos",u.MOUSE_X,e.clientX-n.left),t.onInput("mouse","pos",u.MOUSE_Y,e.clientY-n.top)},e.on("down",this._mousedown),e.on("up",this._mouseup),e.on("move",this._mousemove),this._mouse=e}},{key:"getMouse",value:function(){return this._mouse}},{key:"setGamePad",value:function(e){throw new Error("Sorry, not yet supported.")}},{key:"addContext",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._contexts.push([e,t]),this._contexts.sort(this._priorityComparator),e}},{key:"removeContext",value:function(e){for(var t=this._contexts.length;t--;)if(this._contexts[t][0]==e)return this._contexts.splice(t,1),!0;return!1}},{key:"addCallback",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._callbacks.push([e,t]),this._callbacks.sort(this._priorityComparator),e}},{key:"removeCallback",value:function(e){for(var t=this._callbacks.length;t--;)if(this._callbacks[t][0]==e)return this._callbacks.splice(t,1),!0;return!1}},{key:"doInputUpdate",value:function(){var e=this._inputFrame,t=!0,n=!1,r=void 0;try{for(var o,i=this._contexts[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value[0].onInputUpdate(e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}var a=!0,u=!1,s=void 0;try{for(var l,c=this._callbacks[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){(0,l.value[0])(e)}}catch(e){u=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(u)throw s}}}},{key:"onInput",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this._inputFrame,i=this._inputEvent;"number"==typeof r?(i.down=r>0,i.amount=r):(i.down=r,i.amount=r?1:0),i.id=e+"."+t+"."+n;var a=!1,u=void 0,f=void 0,h=void 0,d=!0,p=!1,v=void 0;try{for(var y,_=this._contexts[Symbol.iterator]();!(d=(y=_.next()).done);d=!0){if((f=(u=y.value[0]).getInputMapping().getMappedInputs(e,t,n))&&f.length>0){var g=!0,m=!1,b=void 0;try{for(var w,E=f[Symbol.iterator]();!(g=(w=E.next()).done);g=!0){var O=w.value;if(null!=(h=O.processInput(i))){if(O instanceof s.default)o.setAction(O.name);else if(O instanceof l.default)u.setActiveState(O.name,h);else{if(!(O instanceof c.default))throw new Error("Unknown input type '"+result+"'");o.setRange(O.name,h)}a=!0}}}catch(e){m=!0,b=e}finally{try{!g&&E.return&&E.return()}finally{if(m)throw b}}if(a)return!0}}}catch(e){p=!0,v=e}finally{try{!d&&_.return&&_.return()}finally{if(p)throw v}}return!1}}]),e}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(2));var i=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=t,this.allowCursorLock=n,this.onMouseMove=this.onMouseMove.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this._down=!1,t.addEventListener("mousedown",this.onMouseDown,!1),document.addEventListener("mousemove",this.onMouseMove,!1),this.onMouseClick=this.onMouseClick.bind(this),t.addEventListener("click",this.onMouseClick,!1),this.registerEvent("move"),this.registerEvent("down"),this.registerEvent("up")}return r(e,[{key:"delete",value:function(){this.hasPointerLock()&&document.exitPointerLock(),this.unregisterEvent("move"),this.unregisterEvent("down"),this.unregisterEvent("up"),this.canvas.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),this.canvas.removeEventListener("click",this.onMouseClick)}},{key:"onMouseClick",value:function(e){this.allowCursorLock&&this.canvas.requestPointerLock()}},{key:"onMouseMove",value:function(e){this.allowCursorLock&&!this.hasPointerLock()||this.emit("move",e)}},{key:"onMouseDown",value:function(e){this.allowCursorLock&&!this.hasPointerLock()||(this._down&&document.removeEventListener("mouseup",this.onMouseUp),this._down=!0,document.addEventListener("mouseup",this.onMouseUp,!1),this.emit("down",e))}},{key:"onMouseUp",value:function(e){this.allowCursorLock&&!this.hasPointerLock()||(document.removeEventListener("mouseup",this.onMouseUp),this._down=!1,this.emit("up",e))}},{key:"hasPointerLock",value:function(){return document.pointerLockElement===this.canvas}}]),e}();o.default.mixin(i),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(2));var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),this.registerEvent("down"),this.registerEvent("up")}return r(e,[{key:"delete",value:function(){this.unregisterEvent("up"),this.unregisterEvent("down"),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)}},{key:"onKeyDown",value:function(e){this.emit("down",e)}},{key:"onKeyUp",value:function(e){this.emit("up",e)}}]),e}();o.default.mixin(i),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.actions=[],this.states=[],this.ranges=new Map}return r(e,[{key:"setAction",value:function(e){this.actions.push(e)}},{key:"hasAction",value:function(e){return this.actions.includes(e)}},{key:"getAction",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!!this.actions.includes(e)&&(t&&this.actions.splice(this.actions.indexOf(e),1),!0)}},{key:"setState",value:function(e){this.states.push(e)}},{key:"hasState",value:function(e){return this.states.includes(e)}},{key:"getState",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!!this.states.includes(e)&&(t&&this.states.splice(this.states.indexOf(e),1),!0)}},{key:"setRange",value:function(e,t){this.ranges.set(e,t)}},{key:"hasRange",value:function(e){return this.ranges.has(e)}},{key:"getRange",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.ranges.has(e)){var n=this.ranges.get(e);return t&&this.ranges.delete(e),n}return null}},{key:"clear",value:function(){this.actions.length=0,this.states.length=0,this.ranges.clear()}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(6));var i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._mapping=t||new o.default,this._activeStates=[]}return r(e,[{key:"onInputUpdate",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this._activeStates[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;e.setState(a)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}},{key:"setActiveState",value:function(e,t){var n=this._activeStates;t?n.includes(e)||n.push(e):n.includes(e)&&n.splice(n.indexOf(e),1)}},{key:"setInputMapping",value:function(e){if(!e)throw new Error("Input mapping cannot be null");this._mapping=e,this._activeStates.length=0}},{key:"getInputMapping",value:function(){return this._mapping}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"onComponentCreate",value:function(e,t){}},{key:"onComponentDestroy",value:function(e,t){}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=c(n(11)),a=n(47),u=n(0),s=c(n(12)),l=c(n(3));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.world=e,n.x=0,n.y=0,n.rotation=u.quat.create(),n.radius=8,n.bufferRadius=.5,n.motion=u.vec2.create(),n.motion[0]=2*Math.random()-1,n.motion[1]=2*Math.random()-1,n.moveSpeed=.5,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"onCreate",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onCreate",this).call(this);var e=this.addComponent(l.default);e.mesh="quad.mesh",e.material="rock.tex"}},{key:"onUpdate",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUpdate",this).call(this,e),this.x+=this.motion[0]*this.moveSpeed*e,this.y+=this.motion[1]*this.moveSpeed*e,this.x<-10?((0,a.reflect2)(this.motion,u.vec2.fromValues(-1,0),this.motion),this.x=-10):this.x>10&&((0,a.reflect2)(this.motion,u.vec2.fromValues(1,0),this.motion),this.x=10),this.y<-10?((0,a.reflect2)(this.motion,u.vec2.fromValues(0,-1),this.motion),this.y=-10):this.y>10&&((0,a.reflect2)(this.motion,u.vec2.fromValues(0,1),this.motion),this.y=10);var n=this.getComponent(l.default);u.mat4.fromRotationTranslationScale(n.transform,this.rotation,u.vec3.fromValues(this.x,this.y,0),u.vec3.fromValues(2*this.radius,2*this.radius,1))}},{key:"onHit",value:function(){this.radius*=.8,this.moveSpeed*=1.1,this.motion[0]=2*Math.random()-1,this.motion[1]=2*Math.random()-1,u.vec2.normalize(this.motion,this.motion);for(var e=0,t=0,n=0;n<10*this.radius||n<=0;++n)e=(Math.random()-.5)*this.radius,t=(Math.random()-.5)*this.radius,this.entityManager.addCustomEntity(new s.default(this.world,this.x+e,this.y+t))}}]),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZAXIS=t.YAXIS=t.XAXIS=t.EPSILON=void 0,t.distSqu=function(e,t,n,r){var o=n-e,i=r-t;return o*o+i*i},t.reflect2=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.vec2.create(),o=e[0]*t[0]+e[1]*t[1],i=t[0]*o,a=t[1]*o,u=e[0]-i,s=e[1]-a;return n[0]=u-i,n[1]=s-a,n},t.abs=function(e){return e<0?-e:e},t.clamp=function(e,t,n){return e<t?t:e>n?n:e},t.sign=function(e){return e<0?-1:1},t.hash3D=function(e,t,n){return 53*(53*(53+o(e))+o(t))+o(n)},t.hash2D=function(e,t){return 53*(53+o(e))+o(t)},t.hashInt=o;var r=n(0);t.EPSILON=1e-8,t.XAXIS=r.vec3.create(1,0,0),t.YAXIS=r.vec3.create(0,1,0),t.ZAXIS=r.vec3.create(0,0,1);function o(e){return e=3042594569^(e=(e=(e=(e=3345072700^(e=e+2127912214+(e<<12))^e>>19)+374761393+(e<<5))+3550635116^e<<9)+4251993797+(e<<3))^e>>16}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"load",value:function(){return console.log("[Renderer] Loading renderer..."),Promise.resolve()}},{key:"unload",value:function(){console.log("[Renderer] Unloading renderer...")}},{key:"update",value:function(){}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._assets=[]}return r(e,[{key:"clear",value:function(){this._assets.length=0}},{key:"addAsset",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if("string"!=typeof e)throw new Error("Asset type must be a string");this._assets.push([e,t,n])}},{key:"removeAsset",value:function(e,t){for(var n=-1,r=(this._assets.length,0);r<lenght;++r)if(assetData[0]===e&&assetData[1]===t){n=r;break}if(!(n>0))throw new Error("Cannot find manifest asset data of type '"+e+"' with url '"+t+"'");this._assets.splice(n,1)}},{key:"toAssetDataList",value:function(){return this._assets.slice()}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),i=u(n(13)),a=u(n(14));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fieldOfView=45*Math.PI/180,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"getProjectionMatrix",value:function(){return o.mat4.perspective(this._projectionMatrix,this.fieldOfView,this.viewport.getAspectRatio(),this.zNear,this.zFar),this._projectionMatrix}},{key:"screenToWorld",value:function(e,t,n){n||(n=new a.default);var r=this.viewport.getWidth(),i=this.viewport.getHeight(),u=this._unprojectVector,s=this.getInvertedProjectionMatrix(),l=this.getInvertedViewMatrix();return u[0]=2*e/r-1,u[1]=1-2*t/i,u[2]=-1,u[3]=1,o.vec4.transformMat4(u,u,s),u[2]=-1,u[3]=0,o.vec4.transformMat4(u,u,l),o.vec4.normalize(u,u),o.vec3.copy(n.direction,u),o.mat4.getTranslation(u,l),o.vec3.copy(n.position,u),n}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),i=u(n(13)),a=u(n(14));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._unprojectVector=o.vec4.create(),n.left=-10,n.right=10,n.bottom=-10,n.top=10,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"getProjectionMatrix",value:function(){return o.mat4.ortho(this._projectionMatrix,this.left,this.right,this.bottom,this.top,this.zNear,this.zFar),this._projectionMatrix}},{key:"screenToWorld",value:function(e,t,n){n||(n=new a.default);var r=this.viewport.getWidth(),i=this.viewport.getHeight(),u=this._unprojectVector,s=this.getInvertedProjectionMatrix(),l=this.getInvertedViewMatrix();return u[0]=2*e/r-1,u[1]=1-2*t/i,u[2]=-1,u[3]=1,o.vec4.transformMat4(u,u,s),u[2]=-1,u[3]=0,o.vec4.transformMat4(u,u,l),o.vec3.copy(n.position,u),o.mat4.getRotation(u,l),u[2]*=-1,o.vec3.copy(n.direction,u),n}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),i=function(e){return e&&e.__esModule?e:{default:e}}(n(3));var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.assetManager=t}return r(e,[{key:"render",value:function(e,t,n){this.renderDrawables(e,t.getEntityManager().getComponentsByClass(i.default),n)}},{key:"renderDrawables",value:function(e,t,n){e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var r=this.assetManager,i=n.getProjectionMatrix(),a=n.getViewMatrix(),u=r.getAssetImmediately("shader","shader.shader"),s=r.getAssetImmediately("texture","color.tex"),l=o.mat4.create(),c=o.mat4.create();u.bind(),e.uniformMatrix4fv(u.uniforms.u_projection,!1,i),e.uniformMatrix4fv(u.uniforms.u_view,!1,a),s.bind(e.TEXTURE0),e.uniform1i(u.uniforms.u_sampler,0);var f=!0,h=!1,d=void 0;try{for(var p,v=t[Symbol.iterator]();!(f=(p=v.next()).done);f=!0){var y=p.value;if(y.visible){var _=y.mesh,g=y.material,m=y.transform;if(g)r.getAssetImmediately("texture",g).bind(e.TEXTURE0);if(_){var b=r.getAssetImmediately("mesh",_);b.bind(u),o.mat4.copy(l,m),e.uniformMatrix4fv(u.uniforms.u_model,!1,l),o.mat4.mul(c,a,l),o.mat4.invert(c,c),o.mat4.transpose(c,c),e.uniformMatrix4fv(u.uniforms.u_normal,!1,c);var w="wireframe"===y.drawMode?e.LINE_LOOP:e.TRIANGLES;b.draw(w)}}}}catch(e){h=!0,d=e}finally{try{!f&&v.return&&v.return()}finally{if(h)throw d}}u.unbind()}}]),e}();t.default=a}]);